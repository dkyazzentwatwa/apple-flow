# Comma-separated values are supported for these list fields.
apple_flow_allowed_senders=+15551234567
apple_flow_allowed_workspaces=/Users/yourname/code

# Optional overrides
apple_flow_default_workspace=/Users/yourname/code/my-project
# apple_flow_log_file_path=logs/apple-flow.err.log
apple_flow_poll_interval_seconds=2
apple_flow_approval_ttl_minutes=20
apple_flow_max_messages_per_minute=30
apple_flow_codex_app_server_cmd=codex app-server

# CLI connector settings (recommended - avoids state corruption)
# Note: setup scripts auto-detect binary paths (e.g. ~/.local/bin/claude)
apple_flow_use_codex_cli=true
apple_flow_codex_cli_command=codex
apple_flow_codex_cli_context_window=10
apple_flow_codex_cli_model=  # Optional: gpt-5.3-codex (empty = use codex default)

# Connector selection (overrides use_codex_cli when set)
# Options: "codex-cli" (default), "claude-cli", "cline", "codex-app-server" (deprecated)
# apple_flow_connector=codex-cli

# Claude CLI connector settings (used when apple_flow_connector=claude-cli)
# Note: setup scripts auto-detect the claude binary path at install time
# apple_flow_claude_cli_command=claude
# apple_flow_claude_cli_dangerously_skip_permissions=true
# apple_flow_claude_cli_context_window=10
# apple_flow_claude_cli_model=  # e.g. claude-sonnet-4-6, claude-opus-4-6
# apple_flow_claude_cli_tools=default,WebSearch
# apple_flow_claude_cli_allowed_tools=WebSearch

# Cline CLI connector settings (used when apple_flow_connector=cline)
# Full agentic execution with any model provider (Kimi k2, GLM-5, Minimax, DeepSeek, Groq, etc.)
# Requires: npm install -g cline && cline auth
# apple_flow_cline_command=cline
# apple_flow_cline_context_window=3
# apple_flow_cline_model=  # e.g. kimi-k2, gpt-4o (empty = cline default)
# apple_flow_cline_use_json=true
# apple_flow_cline_act_mode=true

apple_flow_admin_host=127.0.0.1
apple_flow_admin_port=8787
# Shared-secret token for admin API authentication (empty = no auth).
# When set, all endpoints except /health require: Authorization: Bearer <token>
# apple_flow_admin_api_token=your-secret-token-here
apple_flow_messages_db_path=~/Library/Messages/chat.db
apple_flow_process_historical_on_first_start=false
# On restart, skip messages older than this many seconds (prevents backlog burst). Default: 60
apple_flow_startup_catchup_window_seconds=60
apple_flow_notify_blocked_senders=false
apple_flow_notify_rate_limited_senders=false
apple_flow_only_poll_allowed_senders=true
# require_chat_prefix: set to true to require the relay: prefix on all messages (legacy mode).
# Default is false â€” natural language mode where users can type freely without a prefix.
# Migration: if upgrading and want the old behavior, set this to true.
apple_flow_require_chat_prefix=false
apple_flow_chat_prefix=relay:
apple_flow_suppress_duplicate_outbound_seconds=90
apple_flow_send_startup_intro=true
apple_flow_codex_turn_timeout_seconds=300
# Max AI calls dispatched concurrently across all polling channels (default: 4)
apple_flow_max_concurrent_ai_calls=4

# Apple Mail integration (email as additional ingress alongside iMessage)
# Set enable_mail_polling=true and configure mail_allowed_senders to start.
# Requires Apple Mail to be running and configured on this Mac.
apple_flow_enable_mail_polling=false
apple_flow_mail_poll_account=
apple_flow_mail_poll_mailbox=INBOX
apple_flow_mail_from_address=
apple_flow_mail_allowed_senders=
apple_flow_mail_max_age_days=2
apple_flow_mail_signature=\n\nâ€”\nApple Flow ðŸ¤–, Your 24/7 Assistant

# Apple Reminders integration (Reminders list as task queue alongside iMessage)
# New reminders in the designated list become tasks for Codex.
# Approval conversations happen via iMessage; results are written back to the reminder.
# Requires Reminders.app running on this Mac.
apple_flow_enable_reminders_polling=false
apple_flow_reminders_list_name=agent-task
apple_flow_reminders_archive_list_name=Archive
apple_flow_reminders_owner=
apple_flow_reminders_auto_approve=false
apple_flow_reminders_poll_interval_seconds=5

# Multi-workspace routing (@alias syntax in commands)
# JSON dict mapping alias names to absolute workspace paths.
# Example: task: @web-app deploy to staging
apple_flow_workspace_aliases={"web-app":"/Users/yourname/Projects/web-app","api":"/Users/yourname/Projects/api"}

# AI personality prompt â€” system context injected for all chat turns.
# Override to customize the assistant's tone and behavior.
# Use {workspace} as a placeholder for the default_workspace path.
# apple_flow_personality_prompt=You are a pirate. Arr.

# Conversation memory: auto-inject recent messages into prompts for context continuity.
# Reads from persistent SQLite â€” survives daemon restarts. Set to 0 to disable.
apple_flow_auto_context_messages=10

# Apple Tools context injection â€” tells the AI about apple-flow tools (Notes, Mail, Reminders, Calendar, iMessage).
# Set to false to disable TOOLS_CONTEXT from being prepended to AI prompts.
# apple_flow_inject_tools_context=true

# Global trigger tag â€” items without this tag are silently skipped across all channels
# (Reminders, Mail, Notes, Calendar). Empty string = disabled (process everything).
apple_flow_trigger_tag=!!agent

# Apple Notes integration (Notes folder as long-form task workspace)
# Notes in the designated folder become tasks for Codex.
# Only notes containing the trigger tag will be processed (prevents auto-save issues).
# Results are appended back to the note body.
# After approval, completed notes are moved to the archive subfolder.
# Requires Notes.app running on this Mac.
apple_flow_enable_notes_polling=false
apple_flow_notes_folder_name=agent-task
apple_flow_notes_archive_folder_name=agent-archive
apple_flow_notes_owner=
apple_flow_notes_auto_approve=false
apple_flow_notes_poll_interval_seconds=10
apple_flow_notes_fetch_timeout_seconds=20
apple_flow_notes_fetch_retries=1
apple_flow_notes_fetch_retry_delay_seconds=1.5

# Apple Notes Logging â€” create a new note per AI completion for easy review
# Works independently of notes polling (enable_notes_polling).
apple_flow_enable_notes_logging=false
apple_flow_notes_log_folder_name=agent-logs

# Apple Calendar integration (calendar events as scheduled tasks)
# Events in the designated calendar whose start time arrives become tasks.
# Results are written into the event description/notes.
# Requires Calendar.app running on this Mac.
apple_flow_enable_calendar_polling=false
apple_flow_calendar_name=agent-schedule
apple_flow_calendar_owner=
apple_flow_calendar_auto_approve=false
apple_flow_calendar_poll_interval_seconds=30
apple_flow_calendar_lookahead_minutes=5

# Progress streaming for long tasks
# Sends periodic progress updates via iMessage during task execution.
apple_flow_enable_progress_streaming=false
apple_flow_progress_update_interval_seconds=30

# File attachment support
# Enables reading inbound file attachments and including them in prompts.
apple_flow_enable_attachments=false
apple_flow_max_attachment_size_mb=10
apple_flow_attachment_temp_dir=/tmp/apple_flow_attachments

# --- Autonomous Companion Layer ---

# Agent Office: the companion's workspace with SOUL.md, memory, templates, and logs.
# Path to SOUL.md (relative to repo root or absolute). Defines companion identity.
# If the file doesn't exist, falls back to personality_prompt.
apple_flow_soul_file=agent-office/SOUL.md

# Companion loop: proactive observations sent via iMessage.
# Scans calendar, reminders, approvals, and agent-office inbox periodically.
# Requires at least one allowed_sender configured.
apple_flow_enable_companion=false
apple_flow_companion_poll_interval_seconds=300
apple_flow_companion_max_proactive_per_hour=4
apple_flow_companion_quiet_hours_start=22:00
apple_flow_companion_quiet_hours_end=07:00
apple_flow_companion_stale_approval_minutes=30
apple_flow_companion_calendar_lookahead_minutes=60

# Daily digest (morning briefing via iMessage + daily note in agent-office).
apple_flow_companion_enable_daily_digest=false
apple_flow_companion_digest_time=08:00

# File-based memory: reads/writes agent-office/MEMORY.md and 60_memory/ topic files.
# Injected into AI prompts for persistent context across sessions.
apple_flow_enable_memory=false
apple_flow_memory_max_context_chars=2000

# Follow-up scheduler: schedule check-ins after task completion.
apple_flow_enable_follow_ups=false
apple_flow_default_follow_up_hours=2.0
apple_flow_max_follow_up_nudges=3

# Ambient scanning: passively reads Notes, Calendar, Mail for context enrichment.
# Writes to agent-office memory files without sending messages or triggering actions.
apple_flow_enable_ambient_scanning=false
apple_flow_ambient_scan_interval_seconds=900

# Weekly review: comprehensive summary sent on a configured day/time.
apple_flow_companion_weekly_review_day=sunday
apple_flow_companion_weekly_review_time=20:00

# Agent-office â†’ Supabase sync
# Syncs agent-office markdown files to local Supabase tables (queryable backup).
# Tables: automation_runs, memory_entries, daily_notes, inbox_items, projects.
# Trigger: hourly via companion loop + on-demand via "system: sync office" iMessage.
# Requires: local Supabase running (supabase start) with the office schema migrated.
# apple_flow_enable_office_sync=false
# apple_flow_supabase_url=http://localhost:54321
# apple_flow_supabase_service_key=your-service-role-key-here
# apple_flow_office_sync_interval_seconds=3600
